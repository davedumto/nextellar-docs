---
title: useStellarWallet
description: Complete wallet connection and account management for Stellar dApps
---

# useStellarWallet

The `useStellarWallet` hook provides a complete solution for connecting to Stellar wallets, managing account state, and executing payments. It's the foundation of wallet integration in Nextellar apps.

## Features

- **Multi-Wallet Support**: Freighter, Albedo, Lobstr, xBull, Hana
- **Persistent Connection**: Auto-reconnect on page reload via localStorage
- **Real-Time Balances**: Automatic balance fetching and updates
- **Payment Transactions**: Build, sign, and submit payments
- **Error Handling**: Graceful handling of unfunded accounts and network errors
- **Auto-Refresh**: Manual and automatic balance refresh capabilities

## Basic Usage

```tsx
import { useStellarWallet } from '@/hooks/useStellarWallet';

export default function WalletDemo() {
  const { connected, publicKey, balances, connect, disconnect } =
    useStellarWallet();

  return (
    <div>
      {!connected ? (
        <button onClick={connect}>Connect Wallet</button>
      ) : (
        <div>
          <p>Connected: {publicKey}</p>
          <p>Balance: {balances[0]?.balance} XLM</p>
          <button onClick={disconnect}>Disconnect</button>
        </div>
      )}
    </div>
  );
}
```

## API Reference

### Parameters

```typescript
useStellarWallet(
  horizonUrl?: string,
  network?: string
): StellarWalletState
```

| Parameter    | Type     | Default                                 | Description                |
| ------------ | -------- | --------------------------------------- | -------------------------- |
| `horizonUrl` | `string` | `'https://horizon-testnet.stellar.org'` | Stellar Horizon server URL |
| `network`    | `string` | `Networks.TESTNET`                      | Stellar network passphrase |

### Return Value

```typescript
interface StellarWalletState {
  connected: boolean;
  publicKey?: string;
  walletName?: string;
  balances: Balance[];
  connect: () => Promise<void>;
  disconnect: () => void;
  refreshBalances: () => Promise<void>;
  sendPayment?: (
    opts: PaymentOptions
  ) => Promise<HorizonApi.SubmitTransactionResponse>;
}
```

#### Properties

**`connected`** `boolean`

Whether a wallet is currently connected.

```tsx
{
  connected && <p>Wallet is connected!</p>;
}
```

---

**`publicKey`** `string | undefined`

The connected wallet's Stellar public key (G-address).

```tsx
<p>Your address: {publicKey}</p>
```

---

**`walletName`** `string | undefined`

Name of the connected wallet (e.g., "Freighter", "Albedo").

```tsx
<p>Connected via {walletName}</p>
```

---

**`balances`** `Balance[]`

Array of account balances including XLM and all assets.

```typescript
interface Balance {
  balance: string;
  asset_type: string;
  asset_code?: string;
  asset_issuer?: string;
}
```

```tsx
{
  balances.map((balance) => (
    <div key={balance.asset_code || 'XLM'}>
      {balance.balance} {balance.asset_code || 'XLM'}
    </div>
  ));
}
```

#### Methods

**`connect()`** `() => Promise<void>`

Opens the wallet selection modal and connects to the chosen wallet.

```tsx
const handleConnect = async () => {
  try {
    await connect();
    console.log('Wallet connected!');
  } catch (error) {
    if (error.message.includes('User rejected')) {
      console.log('User cancelled connection');
    }
  }
};
```

---

**`disconnect()`** `() => void`

Disconnects the current wallet and clears all state.

```tsx
<button onClick={disconnect}>Disconnect</button>
```

---

**`refreshBalances()`** `() => Promise<void>`

Manually refresh account balances from Horizon.

```tsx
const handleRefresh = async () => {
  await refreshBalances();
  console.log('Balances updated!');
};
```

---

**`sendPayment()`** `(opts: PaymentOptions) => Promise<TransactionResponse>`

Send a payment transaction. Only available when wallet is connected.

```typescript
interface PaymentOptions {
  to: string;
  amount: string;
  asset?: 'XLM' | { code: string; issuer: string };
  memo?: string;
}
```

```tsx
const result = await sendPayment({
  to: 'GDEF456...',
  amount: '10.5',
  asset: 'XLM',
  memo: 'Payment for services',
});

console.log('Transaction hash:', result.hash);
```

## Advanced Examples

### Custom Network Configuration

Connect to Stellar mainnet instead of testnet:

```tsx
const wallet = useStellarWallet(
  'https://horizon.stellar.org', // Mainnet Horizon
  Networks.PUBLIC // Mainnet passphrase
);
```

### Sending Custom Assets

Send a custom asset instead of XLM:

```tsx
const { sendPayment } = useStellarWallet();

await sendPayment({
  to: 'GDEF456...',
  amount: '100',
  asset: {
    code: 'USDC',
    issuer: 'GA5ZSEJYB37JRC5AVCIA5MOP4RHTM335X2KGX3IHOJAPP5RE34K4KZVN',
  },
  memo: 'USDC payment',
});
```

### Displaying All Balances

Show all assets the account holds:

```tsx
function BalanceList() {
  const { balances, connected } = useStellarWallet();

  if (!connected) return <p>Connect wallet to view balances</p>;

  return (
    <div>
      <h3>Your Balances</h3>
      {balances.length === 0 ? (
        <p>No balances found. Fund your account to get started.</p>
      ) : (
        <ul>
          {balances.map((balance, index) => (
            <li key={index}>
              {balance.balance} {balance.asset_code || 'XLM'}
              {balance.asset_issuer && (
                <span className="text-xs text-muted-foreground">
                  {' '}
                  (Issuer: {balance.asset_issuer.slice(0, 8)}...)
                </span>
              )}
            </li>
          ))}
        </ul>
      )}
    </div>
  );
}
```

### Auto-Refresh Balances After Payment

```tsx
function SendPaymentWithRefresh() {
  const { sendPayment, refreshBalances } = useStellarWallet();

  const handleSend = async () => {
    try {
      await sendPayment({
        to: 'GDEF456...',
        amount: '10',
        asset: 'XLM',
      });

      // Balances are automatically refreshed after successful payment
      // But you can also manually refresh if needed
      await refreshBalances();
    } catch (error) {
      console.error('Payment failed:', error);
    }
  };

  return <button onClick={handleSend}>Send 10 XLM</button>;
}
```

### Handling Unfunded Accounts

```tsx
function AccountStatus() {
  const { connected, publicKey, balances } = useStellarWallet();

  if (!connected) return null;

  if (balances.length === 0) {
    return (
      <div className="bg-yellow-50 border border-yellow-200 p-4 rounded-md">
        <h4 className="font-semibold text-yellow-800">Account Not Funded</h4>
        <p className="text-sm text-yellow-700 mt-1">
          This account doesn't exist on the Stellar network yet. Send at least 1
          XLM to activate it.
        </p>
        <a
          href={`https://laboratory.stellar.org/#account-creator?network=test`}
          target="_blank"
          rel="noopener noreferrer"
          className="text-sm text-yellow-600 hover:underline mt-2 inline-block"
        >
```
