---
title: Wallets (Freighter, Albedo, Lobstr, xBull, Hana)
description: Multi-wallet support in Nextellar using stellar-wallets-kit
---

# Wallet Integration

Nextellar uses [@creit.tech/stellar-wallets-kit](https://github.com/AhaLabs/stellar-wallets-kit) to provide seamless multi-wallet support. This integration enables connecting to Freighter, Albedo, Lobstr, and other Stellar wallets.

## Supported Wallets

Out of the box, Nextellar supports:

| Wallet        | Type              | Features                    |
| ------------- | ----------------- | --------------------------- |
| **Freighter** | Browser Extension | Most popular, full-featured |
| **Albedo**    | Web-based         | No installation required    |
| **Lobstr**    | Browser Extension | Mobile-friendly companion   |
| **xBull**     | Browser Extension | Advanced features           |
| **Hana**      | Browser Extension | Stellar ecosystem wallet    |

## How It Works

### Wallet Kit Configuration

The wallet kit is configured in `src/lib/stellar-wallet-kit.ts`:

```typescript
import {
  StellarWalletsKit,
  FREIGHTER_ID,
  FreighterModule,
  AlbedoModule,
  LobstrModule,
  xBullModule,
  HanaModule,
  WalletNetwork,
} from '@creit.tech/stellar-wallets-kit';

const kit = new StellarWalletsKit({
  network: WalletNetwork.TESTNET,
  selectedWalletId: FREIGHTER_ID,
  modules: [
    new FreighterModule(),
    new AlbedoModule(),
    new LobstrModule(),
    new xBullModule(),
    new HanaModule(),
  ],
});
```

### Connection Flow

1. User clicks "Connect Wallet" (via `WalletConnectButton` or custom UI)
2. Stellar Wallets Kit opens the wallet selection modal
3. User chooses their wallet
4. Wallet extension prompts for permission
5. Public key is retrieved and stored
6. Balances are fetched automatically

## Using Wallet Integration

### With WalletProvider (Recommended)

```tsx
// app/layout.tsx
import { WalletProvider } from '@/contexts';

export default function RootLayout({ children }) {
  return <WalletProvider>{children}</WalletProvider>;
}

// Any component
import { useWallet } from '@/contexts';

function MyComponent() {
  const { connected, publicKey, connect, disconnect, walletName } = useWallet();

  return (
    <button onClick={connected ? disconnect : connect}>
      {connected ? `Disconnect ${walletName}` : 'Connect Wallet'}
    </button>
  );
}
```

### With useStellarWallet (Standalone)

```tsx
import { useStellarWallet } from '@/hooks/useStellarWallet';

function MyComponent() {
  const { connected, publicKey, connect, disconnect } = useStellarWallet();

  // Same interface as useWallet
}
```

### Pre-built Button Component

```tsx
import WalletConnectButton from '@/components/WalletConnectButton';

function Header() {
  return <WalletConnectButton theme="dark" />;
}
```

## Session Persistence

Wallet sessions persist across page reloads via localStorage:

```typescript
// Stored on connection
localStorage.setItem('stellar_wallet_connected', 'true');
localStorage.setItem('stellar_wallet_id', 'freighter');
localStorage.setItem('stellar_wallet_address', 'GABC...');
localStorage.setItem('stellar_wallet_name', 'Freighter');

// Cleared on disconnect
localStorage.removeItem('stellar_wallet_connected');
// ... etc
```

On page load, the provider checks for an existing session and auto-reconnects.

## Transaction Signing

When transactions need to be signed, the wallet kit handles it:

```tsx
import { kit } from '@/lib/stellar-wallet-kit';

// Sign an XDR transaction
const { signedTxXdr } = await kit.signTransaction(unsignedXdr, {
  address: publicKey,
  networkPassphrase: Networks.TESTNET,
});
```

Most hooks handle signing internally:

```tsx
const { sendPayment } = useWallet();

// sendPayment automatically builds, prompts wallet for signing, and submits
await sendPayment({
  to: 'GDEF...',
  amount: '10',
  asset: 'XLM',
});
```

## Adding More Wallets

To add additional wallet support, edit `src/lib/stellar-wallet-kit.ts`:

```typescript
import {
  StellarWalletsKit,
  FreighterModule,
  AlbedoModule,
  LobstrModule,
  xBullModule, // Add new import
} from '@creit.tech/stellar-wallets-kit';

const kit = new StellarWalletsKit({
  network: WalletNetwork.TESTNET,
  selectedWalletId: FREIGHTER_ID,
  modules: [
    new FreighterModule(),
    new AlbedoModule(),
    new LobstrModule(),
    new xBullModule(), // Add to array
  ],
});
```

## Network Configuration

### Testnet (Default)

```typescript
const kit = new StellarWalletsKit({
  network: WalletNetwork.TESTNET,
  // ...
});
```

### Mainnet

```typescript
const kit = new StellarWalletsKit({
  network: WalletNetwork.PUBLIC,
  // ...
});
```

### Dynamic Switching

```typescript
// Store preference
localStorage.setItem('network', 'mainnet');

// Read and configure
const network =
  localStorage.getItem('network') === 'mainnet'
    ? WalletNetwork.PUBLIC
    : WalletNetwork.TESTNET;
```

## Error Handling

### Wallet Not Installed

```tsx
const handleConnect = async () => {
  try {
    await connect();
  } catch (error) {
    if (error.message.includes('not installed')) {
      alert('Please install a Stellar wallet extension');
    }
  }
};
```

### User Rejected

```tsx
try {
  await connect();
} catch (error) {
  if (
    error.message.includes('rejected') ||
    error.message.includes('cancelled')
  ) {
    console.log('User cancelled connection');
  }
}
```

### Transaction Rejection

```tsx
try {
  await sendPayment({ to, amount });
} catch (error) {
  if (error.message.includes('User rejected')) {
    alert('Transaction was cancelled');
  }
}
```

## Wallet State

The `useWallet` hook provides:

```typescript
interface WalletState {
  connected: boolean; // Is wallet connected?
  publicKey?: string; // Stellar G-address
  walletName?: string; // "Freighter", "Albedo", etc.
  balances: Balance[]; // Account balances
  connect: () => Promise<void>;
  disconnect: () => void;
  refreshBalances: () => Promise<void>;
  sendPayment?: (opts) => Promise<TransactionResponse>;
}
```

## Freighter-Specific Notes

Freighter is the most popular Stellar wallet. Some specific notes:

- **Network**: Ensure Freighter is set to the same network (testnet/mainnet) as your app
- **Permissions**: Users may need to allow your site in Freighter settings
- **Multiple Accounts**: Freighter supports multiple accounts - the active one is used

## Related

- [ConnectWalletButton](/docs/components/connect-wallet-button) - Pre-built button component
- [WalletProvider](/docs/hooks/wallet-provider) - Context provider docs
- [useStellarWallet](/docs/hooks/use-stellar-wallet) - Standalone hook docs
- [Wallet Integration Guide](/docs/sdk/wallet-integration) - Advanced setup
